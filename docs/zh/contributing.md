# è´¡çŒ®åˆ° BotRS

æ„Ÿè°¢æ‚¨å¯¹è´¡çŒ® BotRS çš„å…´è¶£ï¼æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å¼€å§‹ä¸ºé¡¹ç›®åšå‡ºè´¡çŒ®ã€‚

## è¡Œä¸ºå‡†åˆ™

é€šè¿‡å‚ä¸æ­¤é¡¹ç›®ï¼Œæ‚¨åŒæ„éµå®ˆæˆ‘ä»¬çš„[è¡Œä¸ºå‡†åˆ™](./CODE_OF_CONDUCT.md)ã€‚è¯·åœ¨è´¡çŒ®ä¹‹å‰é˜…è¯»ã€‚

## å¼€å§‹ä½¿ç”¨

### å‰ç½®æ¡ä»¶

- Rust 1.70 æˆ–æ›´é«˜ç‰ˆæœ¬
- Git
- ä¸€ä¸ª QQ é¢‘é“æœºå™¨äººåº”ç”¨ç¨‹åºï¼ˆç”¨äºæµ‹è¯•ï¼‰

### è®¾ç½®å¼€å‘ç¯å¢ƒ

1. åœ¨ GitHub ä¸Š Fork ä»“åº“
2. åœ¨æœ¬åœ°å…‹éš†æ‚¨çš„ Forkï¼š
   ```bash
   git clone https://github.com/YOUR_USERNAME/botrs.git
   cd botrs
   ```

3. æ·»åŠ ä¸Šæ¸¸ä»“åº“ï¼š
   ```bash
   git remote add upstream https://github.com/YinMo19/botrs.git
   ```

4. å®‰è£…ä¾èµ–é¡¹ï¼š
   ```bash
   cargo build
   ```

5. è¿è¡Œæµ‹è¯•ä»¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼š
   ```bash
   cargo test
   ```

## å¼€å‘å·¥ä½œæµç¨‹

### åœ¨è¿›è¡Œæ›´æ”¹ä¹‹å‰

1. ä¸ºæ‚¨çš„åŠŸèƒ½æˆ–ä¿®å¤åˆ›å»ºæ–°åˆ†æ”¯ï¼š
   ```bash
   git checkout -b feature/ä½ çš„åŠŸèƒ½åç§°
   ```

2. ä¿æŒæ‚¨çš„åˆ†æ”¯ä¸ä¸Šæ¸¸åŒæ­¥ï¼š
   ```bash
   git fetch upstream
   git rebase upstream/main
   ```

### è¿›è¡Œæ›´æ”¹

1. éµå¾ªæˆ‘ä»¬çš„[ç¼–ç æ ‡å‡†](#ç¼–ç æ ‡å‡†)ç¼–å†™ä»£ç 
2. ä¸ºæ–°åŠŸèƒ½æ·»åŠ æµ‹è¯•
3. å¦‚æœéœ€è¦ï¼Œæ›´æ–°æ–‡æ¡£
4. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼š
   ```bash
   cargo test
   cargo clippy
   cargo fmt
   ```

### æäº¤æ›´æ”¹

1. ä½¿ç”¨æ¸…æ™°ã€æè¿°æ€§çš„æ¶ˆæ¯æäº¤æ›´æ”¹ï¼š
   ```bash
   git commit -m "feat: æ·»åŠ å¯¹æ–°æ¶ˆæ¯ç±»å‹çš„æ”¯æŒ"
   ```

2. æ¨é€åˆ°æ‚¨çš„ Forkï¼š
   ```bash
   git push origin feature/ä½ çš„åŠŸèƒ½åç§°
   ```

3. åœ¨ GitHub ä¸Šåˆ›å»º Pull Request

## è´¡çŒ®ç±»å‹

### é”™è¯¯æŠ¥å‘Š

åœ¨æŠ¥å‘Šé”™è¯¯æ—¶ï¼Œè¯·åŒ…æ‹¬ï¼š

- é—®é¢˜çš„æ¸…æ™°æè¿°
- é‡ç°é—®é¢˜çš„æ­¥éª¤
- é¢„æœŸä¸å®é™…è¡Œä¸º
- æ‚¨çš„ç¯å¢ƒï¼ˆRust ç‰ˆæœ¬ã€æ“ä½œç³»ç»Ÿç­‰ï¼‰
- ç›¸å…³çš„ä»£ç ç¤ºä¾‹æˆ–æ—¥å¿—

ä½¿ç”¨æˆ‘ä»¬çš„[é”™è¯¯æŠ¥å‘Šæ¨¡æ¿](./bug_report.md)ã€‚

### åŠŸèƒ½è¯·æ±‚

å¯¹äºåŠŸèƒ½è¯·æ±‚ï¼Œè¯·åŒ…æ‹¬ï¼š

- åŠŸèƒ½çš„æ¸…æ™°æè¿°
- ç”¨ä¾‹å’ŒåŠ¨æœº
- æ¥è‡ªå…¶ä»–åº“çš„ä»»ä½•ç›¸å…³ç¤ºä¾‹
- æ„¿æ„è‡ªå·±å®ç°åŠŸèƒ½

ä½¿ç”¨æˆ‘ä»¬çš„[åŠŸèƒ½è¯·æ±‚æ¨¡æ¿](./feature_request.md)ã€‚

### ä»£ç è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿ä»¥ä¸‹è´¡çŒ®ï¼š

- é”™è¯¯ä¿®å¤
- æ–°åŠŸèƒ½
- æ€§èƒ½æ”¹è¿›
- æ–‡æ¡£æ›´æ–°
- ç¤ºä¾‹ä»£ç 
- æµ‹è¯•è¦†ç›–ç‡æ”¹è¿›

## ç¼–ç æ ‡å‡†

### Rust æŒ‡å—

- éµå¾ª [Rust API æŒ‡å—](https://rust-lang.github.io/api-guidelines/)
- ä½¿ç”¨ `cargo fmt` è¿›è¡Œä»£ç æ ¼å¼åŒ–
- è§£å†³æ‰€æœ‰ `cargo clippy` è­¦å‘Š
- ä¸ºå…¬å…± API ç¼–å†™å…¨é¢çš„æ–‡æ¡£
- ä¸ºæ‰€æœ‰æ–°åŠŸèƒ½æ·»åŠ æµ‹è¯•

### ä»£ç é£æ ¼

```rust
// ä½¿ç”¨æè¿°æ€§åç§°
pub struct MessageParams {
    content: Option<String>,
    embed: Option<MessageEmbed>,
}

// è®°å½•å…¬å…± API
/// åˆ›å»ºå…·æœ‰æ–‡æœ¬å†…å®¹çš„æ–°æ¶ˆæ¯ã€‚
///
/// # å‚æ•°
///
/// * `content` - æ¶ˆæ¯çš„æ–‡æœ¬å†…å®¹
///
/// # ç¤ºä¾‹
///
/// ```
/// let params = MessageParams::new_text("ä½ å¥½ï¼Œä¸–ç•Œï¼");
/// ```
pub fn new_text(content: impl Into<String>) -> Self {
    Self {
        content: Some(content.into()),
        embed: None,
    }
}
```

### é”™è¯¯å¤„ç†

- å¯¹å¯èƒ½å¤±è´¥çš„æ“ä½œä½¿ç”¨ `Result<T, BotError>`
- æä¾›æœ‰æ„ä¹‰çš„é”™è¯¯æ¶ˆæ¯
- ä½¿ç”¨ `thiserror` å¤„ç†é”™è¯¯ç±»å‹
- åœ¨é”™è¯¯é“¾ä¸­åŒ…å«ä¸Šä¸‹æ–‡

### æµ‹è¯•

- ä¸ºæ‰€æœ‰å…¬å…±å‡½æ•°ç¼–å†™å•å…ƒæµ‹è¯•
- å¯¹å¤æ‚å·¥ä½œæµç¨‹ä½¿ç”¨é›†æˆæµ‹è¯•
- å°½å¯èƒ½æ¨¡æ‹Ÿå¤–éƒ¨ä¾èµ–é¡¹
- äº‰å–é«˜æµ‹è¯•è¦†ç›–ç‡

```rust
#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_message_params_creation() {
        let params = MessageParams::new_text("test");
        assert_eq!(params.content, Some("test".to_string()));
    }

    #[tokio::test]
    async fn test_api_call() {
        // æµ‹è¯•å¼‚æ­¥åŠŸèƒ½
    }
}
```

## æ–‡æ¡£

### ä»£ç æ–‡æ¡£

- ä½¿ç”¨ `///` æ³¨é‡Šè®°å½•æ‰€æœ‰å…¬å…± API
- åœ¨æ–‡æ¡£ä¸­åŒ…å«ç¤ºä¾‹
- è§£é‡Šå¤æ‚çš„ç®—æ³•å’Œè®¾è®¡å†³ç­–
- ä½¿ç”¨ `cargo doc` ç”Ÿæˆå’Œå®¡æŸ¥æ–‡æ¡£

### ç”¨æˆ·æ–‡æ¡£

- æ·»åŠ åŠŸèƒ½æ—¶æ›´æ–°ç›¸å…³æŒ‡å—
- åœ¨æ–‡æ¡£ç«™ç‚¹ä¸­åŒ…å«ç¤ºä¾‹
- ä¿æŒæ›´æ–°æ—¥å¿—æœ€æ–°
- å¦‚æœéœ€è¦ï¼Œæ›´æ–° README.md

## æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test

# è¿è¡Œç‰¹å®šæµ‹è¯•
cargo test test_name

# è¿è¡Œå¸¦è¾“å‡ºçš„æµ‹è¯•
cargo test -- --nocapture

# è¿è¡Œé›†æˆæµ‹è¯•
cargo test --test integration_tests
```

### æµ‹è¯•ç¯å¢ƒ

è®¾ç½®æµ‹è¯•ç¯å¢ƒå˜é‡ï¼š

```bash
export QQ_BOT_APP_ID="test_app_id"
export QQ_BOT_SECRET="test_secret"
export RUST_LOG="debug"
```

### ç¼–å†™æµ‹è¯•

- æµ‹è¯•æˆåŠŸå’Œå¤±è´¥æƒ…å†µ
- ä½¿ç”¨æè¿°æ€§æµ‹è¯•åç§°
- ä¿æŒæµ‹è¯•ä¸“æ³¨å’Œç‹¬ç«‹
- å°½å¯èƒ½æ¨¡æ‹Ÿå¤–éƒ¨ API

## Pull Request æµç¨‹

### æäº¤ä¹‹å‰

1. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
2. è¿è¡Œ `cargo clippy` å¹¶è§£å†³è­¦å‘Š
3. è¿è¡Œ `cargo fmt` æ ¼å¼åŒ–ä»£ç 
4. å¦‚æœéœ€è¦ï¼Œæ›´æ–°æ–‡æ¡£
5. ä¸ºé‡è¦æ›´æ”¹æ·»åŠ æ›´æ–°æ—¥å¿—æ¡ç›®

### PR è¦æ±‚

- æ¸…æ™°çš„æ ‡é¢˜å’Œæè¿°
- å¼•ç”¨ç›¸å…³é—®é¢˜
- åŒ…å«æ–°åŠŸèƒ½çš„æµ‹è¯•
- æ›´æ–°æ–‡æ¡£
- éµå¾ªæˆ‘ä»¬çš„æäº¤æ¶ˆæ¯æ ¼å¼

### æäº¤æ¶ˆæ¯æ ¼å¼

æ¬¢è¿è´¡çŒ®ä»£ç ï¼æˆ‘çš„ä¸ªäºº git commit æäº¤é£æ ¼æ˜¯ï¼š

```text
[type] simple message

- detail message 1: detailed description.
- detail message 2: detailed description.
- detail message 3: detailed description.
- detail message 4: detailed description.
- etc.
```

ä¾‹å¦‚ï¼š
```text
[feature] add structured message parameters API

- models/message.rs: add MessageParams, GroupMessageParams, C2CMessageParams, DirectMessageParams structs.
- api.rs: add post_*_with_params methods for structured parameter sending.
- examples/: add demo_new_message_api.rs showing the new API usage.
- deprecate old multi-parameter API methods but keep backward compatibility.
```

### å®¡æŸ¥æµç¨‹

1. ç»´æŠ¤è€…å°†å®¡æŸ¥æ‚¨çš„ PR
2. è§£å†³åé¦ˆå’Œè¯·æ±‚çš„æ›´æ”¹
3. ä¸€æ—¦è·å¾—æ‰¹å‡†ï¼Œæ‚¨çš„ PR å°†è¢«åˆå¹¶
4. æ‚¨çš„è´¡çŒ®å°†åœ¨å‘å¸ƒä¸­å¾—åˆ°è®¤å¯

## å‘å¸ƒæµç¨‹

### ç‰ˆæœ¬æ§åˆ¶

æˆ‘ä»¬éµå¾ª[è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶](https://semver.org/)ï¼š

- `MAJOR`: ä¸å…¼å®¹çš„ API æ›´æ”¹
- `MINOR`: å‘åå…¼å®¹çš„åŠŸèƒ½
- `PATCH`: å‘åå…¼å®¹çš„é”™è¯¯ä¿®å¤

### å‘å¸ƒæ¸…å•

1. æ›´æ–° `Cargo.toml` ä¸­çš„ç‰ˆæœ¬
2. æ›´æ–° `CHANGELOG.md`
3. åˆ›å»ºå‘å¸ƒæ ‡ç­¾
4. å‘å¸ƒåˆ° crates.io
5. æ›´æ–°æ–‡æ¡£

## ç¤¾åŒº

### è·å–å¸®åŠ©

- [GitHub è®¨è®º](https://github.com/YinMo19/botrs/discussions) ç”¨äºé—®é¢˜
- [Discord æœåŠ¡å™¨](https://discord.gg/eRRkYfcG8u) ç”¨äºå®æ—¶èŠå¤©
- [GitHub Issues](https://github.com/YinMo19/botrs/issues) ç”¨äºé”™è¯¯å’ŒåŠŸèƒ½

### è®¤å¯

è´¡çŒ®è€…åœ¨ä»¥ä¸‹æ–¹é¢å¾—åˆ°è®¤å¯ï¼š

- å‘å¸ƒè¯´æ˜
- README ä¸­çš„è´¡çŒ®è€…éƒ¨åˆ†
- æ–‡æ¡£ä¸­çš„åäººå ‚

## è®¸å¯è¯

é€šè¿‡ä¸º BotRS åšå‡ºè´¡çŒ®ï¼Œæ‚¨åŒæ„æ‚¨çš„è´¡çŒ®å°†åœ¨ MIT è®¸å¯è¯ä¸‹è·å¾—è®¸å¯ã€‚

## æœ‰é—®é¢˜å—ï¼Ÿ

å¦‚æœæ‚¨å¯¹è´¡çŒ®æœ‰ç–‘é—®ï¼Œè¯·ï¼š

1. æ£€æŸ¥ç°æœ‰çš„é—®é¢˜å’Œè®¨è®º
2. åœ¨æˆ‘ä»¬çš„ Discord æœåŠ¡å™¨ä¸­è¯¢é—®
3. åœ¨ GitHub ä¸Šå¼€å¯è®¨è®º
4. ç›´æ¥è”ç³»ç»´æŠ¤è€…

æ„Ÿè°¢æ‚¨ä¸º BotRS åšå‡ºè´¡çŒ®ï¼ğŸš€
